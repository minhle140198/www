{"ast":null,"code":"import _objectSpread from\"/Users/monsama/firetable/www/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/monsama/firetable/www/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/Users/monsama/firetable/www/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{createStyles,makeStyles}from\"@material-ui/core/styles\";import List from\"@material-ui/core/List\";import ListItem from\"@material-ui/core/ListItem\";import ListItemText from\"@material-ui/core/ListItemText\";import algoliasearch from\"algoliasearch/lite\";import Modal from\"@material-ui/core/Modal\";import Backdrop from\"@material-ui/core/Backdrop\";import Fade from\"@material-ui/core/Fade\";import Paper from\"@material-ui/core/Paper\";import TextField from\"@material-ui/core/TextField\";var searchClient=algoliasearch(process.env.REACT_APP_ALGOLIA_APP_ID?process.env.REACT_APP_ALGOLIA_APP_ID:\"\",process.env.REACT_APP_ALGOLIA_SEARCH_API_KEY?process.env.REACT_APP_ALGOLIA_SEARCH_API_KEY:\"\");var useStyles=makeStyles(function(){return createStyles({modal:{display:\"flex\",alignItems:\"center\",justifyContent:\"center\"},paper:{},root:{position:\"relative\",display:\"flex\",flexWrap:\"wrap\",minWidth:200},typography:{},searchField:{width:\"100%\",padding:20},list:{backgroundColor:\"#fff\",minWidth:200,maxHeight:400,overflowY:\"scroll\"}});});var SearchBox=function SearchBox(props){var searchData=props.searchData,clearSearch=props.clearSearch;var collection=searchData.collection,onSubmit=searchData.onSubmit,config=searchData.config;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),query=_useState2[0],setQuery=_useState2[1];var classes=useStyles();var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),hits=_useState4[0],setHits=_useState4[1];var _useState5=useState(undefined),_useState6=_slicedToArray(_useState5,2),algoliaIndex=_useState6[0],setAlgoliaIndex=_useState6[1];useEffect(function(){if(collection){setAlgoliaIndex(searchClient.initIndex(collection));}},[collection]);useEffect(function(){if(algoliaIndex){search(\"\");}},[algoliaIndex]);var search=function search(query){var resp;return _regeneratorRuntime.async(function search$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!algoliaIndex){_context.next=5;break;}_context.next=3;return _regeneratorRuntime.awrap(algoliaIndex.search({query:query}));case 3:resp=_context.sent;setHits(resp.hits);case 5:case\"end\":return _context.stop();}}});};useEffect(function(){search(query);},[query]);var open=Boolean(collection);var id=open?\"no-transition-popper\":undefined;var Hit=function Hit(hit){return React.createElement(ListItem,{button:true,onClick:function onClick(){var snapshot=_objectSpread({},hit);delete snapshot._highlightResult;if(onSubmit){onSubmit({snapshot:snapshot,docPath:\"\".concat(collection,\"/\").concat(snapshot.objectID)});clear();}}},React.createElement(ListItemText,{primary:config&&config.primaryKeys.map(function(key){return\"\".concat(hit[key],\" \");}),secondary:config&&config.secondaryKeys.map(function(key){return\"\".concat(hit[key],\" \");})}));};var clear=function clear(){return _regeneratorRuntime.async(function clear$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(setHits([]));case 2:_context2.next=4;return _regeneratorRuntime.awrap(setQuery(\"\"));case 4:clearSearch();case 5:case\"end\":return _context2.stop();}}});};return React.createElement(Modal,{\"aria-labelledby\":\"transition-modal-title\",\"aria-describedby\":\"transition-modal-description\",className:classes.modal,open:open,onClose:function onClose(){clear();},closeAfterTransition:true,BackdropComponent:Backdrop,BackdropProps:{timeout:500}},React.createElement(Fade,{in:open},React.createElement(Paper,{className:classes.paper},React.createElement(TextField,{className:classes.searchField,placeholder:\"type to start searching\",autoFocus:true,value:query,onChange:function onChange(e){setQuery(e.target.value);}}),React.createElement(List,{className:classes.list},hits.map(function(hit){return Hit(hit);})))));};export default SearchBox;","map":{"version":3,"sources":["/Users/monsama/firetable/www/src/components/SearchBox.tsx"],"names":["React","useState","useEffect","createStyles","makeStyles","List","ListItem","ListItemText","algoliasearch","Modal","Backdrop","Fade","Paper","TextField","searchClient","process","env","REACT_APP_ALGOLIA_APP_ID","REACT_APP_ALGOLIA_SEARCH_API_KEY","useStyles","modal","display","alignItems","justifyContent","paper","root","position","flexWrap","minWidth","typography","searchField","width","padding","list","backgroundColor","maxHeight","overflowY","SearchBox","props","searchData","clearSearch","collection","onSubmit","config","query","setQuery","classes","hits","setHits","undefined","algoliaIndex","setAlgoliaIndex","initIndex","search","resp","open","Boolean","id","Hit","hit","snapshot","_highlightResult","docPath","objectID","clear","primaryKeys","map","key","secondaryKeys","timeout","e","target","value"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { createStyles, makeStyles } from \"@material-ui/core/styles\";\nimport List from \"@material-ui/core/List\";\nimport ListItem from \"@material-ui/core/ListItem\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\n\nimport algoliasearch from \"algoliasearch/lite\";\n\nimport Modal from \"@material-ui/core/Modal\";\nimport Backdrop from \"@material-ui/core/Backdrop\";\nimport Fade from \"@material-ui/core/Fade\";\nimport Paper from \"@material-ui/core/Paper\";\n\nimport TextField from \"@material-ui/core/TextField\";\n\nconst searchClient = algoliasearch(\n  process.env.REACT_APP_ALGOLIA_APP_ID\n    ? process.env.REACT_APP_ALGOLIA_APP_ID\n    : \"\",\n  process.env.REACT_APP_ALGOLIA_SEARCH_API_KEY\n    ? process.env.REACT_APP_ALGOLIA_SEARCH_API_KEY\n    : \"\"\n);\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    modal: {\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n    },\n    paper: {},\n    root: {\n      position: \"relative\",\n      display: \"flex\",\n      flexWrap: \"wrap\",\n      minWidth: 200,\n    },\n    typography: {},\n\n    searchField: {\n      width: \"100%\",\n      padding: 20,\n    },\n    list: {\n      backgroundColor: \"#fff\",\n      minWidth: 200,\n      maxHeight: 400,\n      overflowY: \"scroll\",\n    },\n  })\n);\ninterface Props {\n  searchData: {\n    collection: string;\n    onSubmit: Function | undefined;\n    config: any;\n  };\n  clearSearch: Function;\n}\n\nconst SearchBox = (props: Props) => {\n  const { searchData, clearSearch } = props;\n  const { collection, onSubmit, config } = searchData;\n  const [query, setQuery] = useState(\"\");\n  const classes = useStyles();\n\n  const [hits, setHits] = useState<any[]>([]);\n  const [algoliaIndex, setAlgoliaIndex] = useState<\n    algoliasearch.Index | undefined\n  >(undefined);\n  useEffect(() => {\n    if (collection) {\n      setAlgoliaIndex(searchClient.initIndex(collection));\n    }\n  }, [collection]);\n  useEffect(() => {\n    if (algoliaIndex) {\n      search(\"\");\n    }\n  }, [algoliaIndex]);\n\n  const search = async (query: string) => {\n    if (algoliaIndex) {\n      const resp = await algoliaIndex.search({ query });\n      setHits(resp.hits);\n    }\n  };\n  useEffect(() => {\n    search(query);\n  }, [query]);\n\n  const open = Boolean(collection);\n  const id = open ? \"no-transition-popper\" : undefined;\n  const Hit = (hit: any) => (\n    <ListItem\n      button\n      onClick={() => {\n        let snapshot = { ...hit };\n        delete snapshot._highlightResult;\n        if (onSubmit) {\n          onSubmit({ snapshot, docPath: `${collection}/${snapshot.objectID}` });\n          clear();\n        }\n      }}\n    >\n      <ListItemText\n        primary={\n          config && config.primaryKeys.map((key: string) => `${hit[key]} `)\n        }\n        secondary={\n          config && config.secondaryKeys.map((key: string) => `${hit[key]} `)\n        }\n      />\n    </ListItem>\n  );\n  const clear = async () => {\n    await setHits([]);\n    await setQuery(\"\");\n    clearSearch();\n  };\n  return (\n    <Modal\n      aria-labelledby=\"transition-modal-title\"\n      aria-describedby=\"transition-modal-description\"\n      className={classes.modal}\n      open={open}\n      onClose={() => {\n        clear();\n      }}\n      closeAfterTransition\n      BackdropComponent={Backdrop}\n      BackdropProps={{\n        timeout: 500,\n      }}\n    >\n      <Fade in={open}>\n        <Paper className={classes.paper}>\n          <TextField\n            className={classes.searchField}\n            placeholder=\"type to start searching\"\n            autoFocus\n            value={query}\n            onChange={(e: React.ChangeEvent<HTMLTextAreaElement>) => {\n              setQuery(e.target.value);\n            }}\n          />\n          {/* results for {query} */}\n          <List className={classes.list}>\n            {hits.map((hit: any) => Hit(hit))}\n          </List>\n        </Paper>\n      </Fade>\n    </Modal>\n  );\n};\nexport default SearchBox;\n"]},"metadata":{},"sourceType":"module"}